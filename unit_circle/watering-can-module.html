<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Watering Can â€” Module</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital@0;1&family=Crimson+Pro:wght@300;400;600&display=swap" rel="stylesheet">
<style>

/* ================================================
   WATERING CAN MODULE CSS
   Copy this block into your game's stylesheet
   ================================================ */

:root {
  --bg:          #0f1a12;
  --card:        #121f15;
  --border:      #1e3a22;
  --stem:        #3d7a4a;
  --leaf:        #4a9e5c;
  --leaf-dark:   #2d6b3a;
  --water-blue:  #3a9ad9;
  --water-light: #5bc0f8;
  --soil:        #5c3d1e;
  --soil-light:  #7a5230;
  --text:        #c8e6c9;
  --text-dim:    #4a7c50;
  --gold:        #ffbe0b;
  --petal-a:     #f4a261;
  --petal-b:     #e76f51;
  --petal-c:     #f9c784;
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

/* â”€â”€ Demo shell (remove in your game) â”€â”€ */
body {
  background: var(--bg);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  font-family: 'Crimson Pro', serif;
  color: var(--text);
  gap: 40px;
}

.demo-label {
  font-family: 'Playfair Display', serif;
  font-style: italic;
  font-size: 1.1rem;
  color: var(--text-dim);
  letter-spacing: 0.04em;
}

.demo-btn {
  padding: 10px 30px;
  background: transparent;
  border: 1px solid var(--stem);
  border-radius: 10px;
  color: var(--text);
  font-family: 'Crimson Pro', serif;
  font-size: 1rem;
  letter-spacing: 0.1em;
  cursor: pointer;
  transition: background 0.2s, box-shadow 0.2s;
}
.demo-btn:hover { background: #1a3a1e; box-shadow: 0 0 12px rgba(61,122,74,0.3); }
.demo-btn.danger { border-color: var(--soil); color: #a07850; }
.demo-btn.danger:hover { background: #1a0e06; }

/* ================================================
   THE MODULE â€” #wc-module
   ================================================ */

#wc-module {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 18px;
  position: relative;
  /* Set width in your game â€” e.g. fits inside a bottom bar */
  width: 220px;
}

/* â”€â”€ Status text â”€â”€ */
#wc-status {
  font-size: 0.8rem;
  color: var(--text-dim);
  letter-spacing: 0.12em;
  text-transform: uppercase;
  text-align: center;
  min-height: 18px;
  transition: color 0.3s;
}
#wc-status.ready  { color: var(--water-blue); }
#wc-status.poured { color: var(--petal-a); }

/* â”€â”€ Can outer wrapper (clickable when full) â”€â”€ */
#wc-can-outer {
  position: relative;
  width: 140px;
  height: 120px;
  cursor: default;
  transition: filter 0.4s;
}
#wc-can-outer.full {
  cursor: pointer;
  filter: drop-shadow(0 0 14px rgba(58,154,217,0.55));
  animation: canPulse 2s ease-in-out infinite;
}
#wc-can-outer.full:hover {
  filter: drop-shadow(0 0 22px rgba(91,192,248,0.8));
}
#wc-can-outer.pouring {
  animation: canTilt 0.6s cubic-bezier(0.4,0,0.2,1) forwards;
  cursor: default;
  pointer-events: none;
}

@keyframes canPulse {
  0%, 100% { filter: drop-shadow(0 0 10px rgba(58,154,217,0.4)); }
  50%       { filter: drop-shadow(0 0 20px rgba(91,192,248,0.75)); }
}
@keyframes canTilt {
  0%   { transform: rotate(0deg) translate(0,0); }
  30%  { transform: rotate(-35deg) translate(-10px, -8px); }
  60%  { transform: rotate(-40deg) translate(-12px,-10px); }
  100% { transform: rotate(-40deg) translate(-12px,-10px); }
}

/* â”€â”€ The SVG can itself â”€â”€ */
#wc-svg {
  width: 100%;
  height: 100%;
  overflow: visible;
}

/* â”€â”€ Water fill rect (animated via JS) â”€â”€ */
#wc-water {
  transition: y 0.55s cubic-bezier(0.4,0,0.2,1),
              height 0.55s cubic-bezier(0.4,0,0.2,1),
              opacity 0.3s;
}

/* â”€â”€ Shimmer lines inside water â”€â”€ */
#wc-shimmer line {
  animation: shimmerMove 3s ease-in-out infinite alternate;
}
#wc-shimmer line:nth-child(2) { animation-delay: 0.5s; }
#wc-shimmer line:nth-child(3) { animation-delay: 1s; }
@keyframes shimmerMove {
  0%   { transform: translateX(-3px); opacity: 0.15; }
  100% { transform: translateX(3px);  opacity: 0.35; }
}

/* â”€â”€ Ripple ring when full â”€â”€ */
.wc-ripple {
  position: absolute;
  inset: 10px;
  border-radius: 50%;
  border: 2px solid rgba(91,192,248,0.7);
  pointer-events: none;
  animation: rippleOut 1.6s ease-out infinite;
}
.wc-ripple:nth-child(2) { animation-delay: 0.55s; }
.wc-ripple:nth-child(3) { animation-delay: 1.1s; }
@keyframes rippleOut {
  0%   { transform: scale(0.7); opacity: 0.8; }
  100% { transform: scale(1.4); opacity: 0;   }
}

/* â”€â”€ Dot progress track â”€â”€ */
.wc-dots {
  display: flex;
  gap: 7px;
  align-items: center;
}
.wc-dot {
  width: 9px;
  height: 9px;
  border-radius: 50%;
  background: #1a2e1e;
  border: 1px solid #2a4d2e;
  transition: background 0.25s, border-color 0.25s, box-shadow 0.25s, transform 0.3s;
}
.wc-dot.on {
  background: var(--water-blue);
  border-color: var(--water-light);
  box-shadow: 0 0 7px rgba(58,154,217,0.6);
}
.wc-dot.pop {
  animation: dotBounce 0.4s cubic-bezier(0.34,1.56,0.64,1);
}
@keyframes dotBounce {
  0%   { transform: scale(0); }
  100% { transform: scale(1); }
}

/* â”€â”€ Fill counter â”€â”€ */
#wc-counter {
  font-size: 0.78rem;
  color: var(--text-dim);
  letter-spacing: 0.1em;
  text-align: center;
}

/* ================================================
   POUR / SPLASH ANIMATIONS  (appended via JS)
   ================================================ */

.wc-stream {
  position: fixed;
  width: 4px;
  border-radius: 3px;
  background: linear-gradient(to bottom,
    rgba(91,192,248,0.9) 0%,
    rgba(58,154,217,0.4) 100%);
  transform-origin: top center;
  pointer-events: none;
  animation: streamGrow 0.45s ease-in forwards;
  z-index: 999;
}
@keyframes streamGrow {
  0%   { height: 0;     opacity: 1; }
  70%  { height: 80px;  opacity: 1; }
  100% { height: 90px;  opacity: 0.2; }
}

.wc-drop {
  position: fixed;
  border-radius: 50%;
  background: rgba(91,192,248,0.75);
  pointer-events: none;
  z-index: 999;
  animation: dropFly var(--dur, 0.65s) ease-out forwards;
}
@keyframes dropFly {
  0%   { transform: scale(0) translate(0,0);        opacity: 1; }
  60%  { opacity: 0.9; }
  100% { transform: scale(1) translate(var(--tx),var(--ty)); opacity: 0; }
}

.wc-splash-ring {
  position: fixed;
  border: 2px solid rgba(91,192,248,0.6);
  border-radius: 50%;
  pointer-events: none;
  z-index: 998;
  animation: splashRing 0.5s ease-out forwards;
}
@keyframes splashRing {
  0%   { width: 6px; height: 6px; opacity: 0.8; margin: -3px; }
  100% { width: 50px; height: 20px; opacity: 0; margin: -10px -25px; }
}

</style>
</head>
<body>

<!-- â”€â”€ Demo shell (remove in your game) â”€â”€ -->
<p class="demo-label">Simulating correct answers from your math game</p>

<div style="display:flex;gap:14px;flex-wrap:wrap;justify-content:center;">
  <button class="demo-btn" id="btn-correct">âœ“ Correct Answer</button>
  <button class="demo-btn danger" id="btn-reset">â†º Reset</button>
</div>

<p id="demo-log" style="color:var(--water-light);font-size:0.85rem;min-height:20px;letter-spacing:0.06em;"></p>

<!-- ================================================
     MODULE HTML â€” copy #wc-module into your game
     ================================================ -->
<div id="wc-module">
  <div id="wc-status">Answer correctly to fill the can</div>

  <div id="wc-can-outer" onclick="WateringCan.pour()">
    <!-- ripple rings injected by JS when full -->
    <svg id="wc-svg" viewBox="0 0 140 120">
      <defs>
        <!-- clip to can body interior -->
        <clipPath id="wc-body-clip">
          <rect x="18" y="22" width="68" height="64" rx="6"/>
        </clipPath>
        <filter id="wc-glow">
          <feGaussianBlur stdDeviation="3" result="b"/>
          <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
        </filter>
      </defs>

      <!-- â”€â”€ Can body shadow â”€â”€ -->
      <rect x="20" y="26" width="68" height="64" rx="6"
            fill="rgba(0,0,0,0.35)" transform="translate(3,4)"/>

      <!-- â”€â”€ Can body â”€â”€ -->
      <rect x="18" y="22" width="68" height="64" rx="6"
            fill="#0e1e11" stroke="#2a4d2e" stroke-width="1.8"/>

      <!-- â”€â”€ Water fill (clipped to body) â”€â”€ -->
      <rect id="wc-water"
            x="18" y="86" width="68" height="0" rx="5"
            fill="var(--water-blue)" opacity="0.8"
            clip-path="url(#wc-body-clip)"/>

      <!-- â”€â”€ Water surface highlight â”€â”€ -->
      <rect id="wc-surface"
            x="18" y="86" width="68" height="3" rx="1.5"
            fill="var(--water-light)" opacity="0"
            clip-path="url(#wc-body-clip)"/>

      <!-- â”€â”€ Shimmer lines (clipped) â”€â”€ -->
      <g id="wc-shimmer" clip-path="url(#wc-body-clip)" opacity="0">
        <line x1="26" y1="70" x2="42" y2="70"
              stroke="rgba(255,255,255,0.25)" stroke-width="1.5" stroke-linecap="round"/>
        <line x1="48" y1="75" x2="70" y2="75"
              stroke="rgba(255,255,255,0.18)" stroke-width="1.5" stroke-linecap="round"/>
        <line x1="30" y1="80" x2="56" y2="80"
              stroke="rgba(255,255,255,0.12)" stroke-width="1.5" stroke-linecap="round"/>
      </g>

      <!-- â”€â”€ Can body border (drawn over water) â”€â”€ -->
      <rect x="18" y="22" width="68" height="64" rx="6"
            fill="none" stroke="var(--stem)" stroke-width="1.8"/>

      <!-- â”€â”€ Lid â”€â”€ -->
      <rect x="22" y="16" width="60" height="9" rx="4"
            fill="#121f15" stroke="var(--stem)" stroke-width="1.5"/>
      <!-- Lid knob -->
      <rect x="46" y="10" width="16" height="8" rx="3"
            fill="#121f15" stroke="var(--stem)" stroke-width="1.3"/>
      <!-- Lid centre line -->
      <line x1="52" y1="13" x2="58" y2="13"
            stroke="var(--stem)" stroke-width="0.8" opacity="0.5"/>

      <!-- â”€â”€ Spout â”€â”€ -->
      <path d="M86,36 C100,33 114,38 120,46"
            stroke="var(--stem)" stroke-width="3.5"
            fill="none" stroke-linecap="round"/>
      <!-- Spout rose (holes) -->
      <circle cx="120" cy="47" r="4.5"
              fill="#0e1e11" stroke="var(--stem)" stroke-width="1.5"/>
      <circle cx="118" cy="51" r="1.8" fill="var(--stem)" opacity="0.7"/>
      <circle cx="122" cy="50" r="1.5" fill="var(--stem)" opacity="0.6"/>
      <circle cx="120" cy="54" r="1.3" fill="var(--stem)" opacity="0.5"/>
      <circle cx="116" cy="53" r="1.2" fill="var(--stem)" opacity="0.4"/>
      <circle cx="124" cy="53" r="1.1" fill="var(--stem)" opacity="0.4"/>

      <!-- â”€â”€ Handle â”€â”€ -->
      <path d="M24,28 C8,28 4,40 4,48 C4,58 8,70 24,72"
            stroke="var(--stem)" stroke-width="3"
            fill="none" stroke-linecap="round"/>
      <!-- Handle grip dots -->
      <circle cx="6" cy="46" r="1.5" fill="var(--stem)" opacity="0.4"/>
      <circle cx="5" cy="52" r="1.5" fill="var(--stem)" opacity="0.4"/>

      <!-- â”€â”€ Measurement tick marks â”€â”€ -->
      <line x1="88" y1="34" x2="93" y2="34" stroke="#2a4d2e" stroke-width="1.2"/>
      <line x1="88" y1="47" x2="93" y2="47" stroke="#2a4d2e" stroke-width="1.2"/>
      <line x1="88" y1="60" x2="93" y2="60" stroke="#2a4d2e" stroke-width="1.2"/>
      <line x1="88" y1="73" x2="93" y2="73" stroke="#2a4d2e" stroke-width="1.2"/>
      <!-- Tick labels -->
      <text x="95" y="37" fill="#2a4d2e" font-size="6" font-family="serif">Â¾</text>
      <text x="95" y="50" fill="#2a4d2e" font-size="6" font-family="serif">Â½</text>
      <text x="95" y="63" fill="#2a4d2e" font-size="6" font-family="serif">Â¼</text>

      <!-- â”€â”€ Decorative band â”€â”€ -->
      <rect x="18" y="50" width="68" height="2" rx="1"
            fill="none" stroke="#1e3a22" stroke-width="1" opacity="0.6"/>

    </svg>
  </div>

  <!-- Dot track -->
  <div class="wc-dots" id="wc-dots"></div>
  <div id="wc-counter">0 / 5 correct answers</div>
</div>
<!-- â”€â”€ end MODULE HTML â”€â”€ -->


<!-- ================================================
     MODULE JS â€” copy WateringCan object into your game
     ================================================ -->
<script>
const WateringCan = (() => {

  /* â”€â”€ Config (tweak for your game) â”€â”€ */
  const ANSWERS_TO_FILL = 5;   // correct answers needed to fill can

  /* â”€â”€ State â”€â”€ */
  let filled      = 0;         // current correct answers
  let isFull      = false;
  let isPouring   = false;

  /* â”€â”€ DOM â”€â”€ */
  const outer    = document.getElementById('wc-can-outer');
  const water    = document.getElementById('wc-water');
  const surface  = document.getElementById('wc-surface');
  const shimmer  = document.getElementById('wc-shimmer');
  const statusEl = document.getElementById('wc-status');
  const dotsEl   = document.getElementById('wc-dots');
  const counter  = document.getElementById('wc-counter');

  /* Can interior geometry (matches SVG viewBox coords projected to screen) */
  const CAN_TOP_Y  = 22;   // SVG y of top of water area
  const CAN_BOT_Y  = 86;   // SVG y of bottom of water area
  const CAN_HEIGHT = CAN_BOT_Y - CAN_TOP_Y;  // 64px in SVG space

  /* â”€â”€ Build dot indicators â”€â”€ */
  function buildDots() {
    dotsEl.innerHTML = '';
    for (let i = 0; i < ANSWERS_TO_FILL; i++) {
      const d = document.createElement('div');
      d.className = 'wc-dot';
      d.id = `wc-dot-${i}`;
      dotsEl.appendChild(d);
    }
  }

  /* â”€â”€ Update water fill level â”€â”€ */
  function setFillLevel(count) {
    const pct   = count / ANSWERS_TO_FILL;
    const fillH = Math.round(CAN_HEIGHT * pct);
    const fillY = CAN_BOT_Y - fillH;

    water.setAttribute('y',      fillY);
    water.setAttribute('height', fillH);

    // Surface highlight
    surface.setAttribute('y',       fillY);
    surface.setAttribute('opacity', pct > 0 ? 0.6 : 0);

    // Shimmer
    shimmer.style.opacity = pct > 0.25 ? 1 : 0;

    // Dots
    for (let i = 0; i < ANSWERS_TO_FILL; i++) {
      const dot = document.getElementById(`wc-dot-${i}`);
      if (!dot) continue;
      if (i < count) {
        if (!dot.classList.contains('on')) {
          dot.classList.add('on');
          dot.classList.remove('pop');
          void dot.offsetWidth; // reflow
          dot.classList.add('pop');
        }
      } else {
        dot.classList.remove('on', 'pop');
      }
    }

    counter.textContent = `${count} / ${ANSWERS_TO_FILL} correct answers`;
  }

  /* â”€â”€ Set full state â”€â”€ */
  function setFull(full) {
    isFull = full;
    outer.classList.toggle('full', full);

    // Ripple rings
    document.querySelectorAll('.wc-ripple').forEach(r => r.remove());
    if (full) {
      for (let i = 0; i < 3; i++) {
        const r = document.createElement('div');
        r.className = 'wc-ripple';
        outer.appendChild(r);
      }
      setStatus('Can is full â€” click to water! ðŸ’§', 'ready');
      document.dispatchEvent(new CustomEvent('wc:full'));
    }
  }

  /* â”€â”€ Status helper â”€â”€ */
  function setStatus(msg, cls = '') {
    statusEl.textContent = msg;
    statusEl.className = cls ? `wc-status ${cls}` : 'wc-status'; // keep selector simple
    statusEl.id = 'wc-status'; // preserve id
  }

  /* â”€â”€ Pour + splash animation â”€â”€ */
  function doPourAnimation(onComplete) {
    // Get screen position of spout rose on the SVG
    const svgEl   = document.getElementById('wc-svg');
    const svgRect = svgEl.getBoundingClientRect();
    const vb      = 140; // viewBox width

    // Spout rose is at SVG coords (120, 47)
    const scaleX  = svgRect.width  / vb;
    const scaleY  = svgRect.height / (120);
    const spoutX  = svgRect.left + 120 * scaleX;
    const spoutY  = svgRect.top  + 47  * scaleY;

    // Tilt the can
    outer.classList.add('pouring');

    // After tilt, spawn stream + drops
    setTimeout(() => {
      // Stream
      const stream = document.createElement('div');
      stream.className = 'wc-stream';
      stream.style.left = (spoutX - 2) + 'px';
      stream.style.top  = spoutY + 'px';
      document.body.appendChild(stream);
      setTimeout(() => stream.remove(), 600);

      // Splash drops (staggered)
      const splashX = spoutX;
      const splashY = spoutY + 85;

      // Ground ring
      const ring = document.createElement('div');
      ring.className = 'wc-splash-ring';
      ring.style.left = splashX + 'px';
      ring.style.top  = splashY + 'px';
      document.body.appendChild(ring);
      setTimeout(() => ring.remove(), 600);

      // Individual droplets
      for (let i = 0; i < 12; i++) {
        setTimeout(() => {
          const drop = document.createElement('div');
          drop.className = 'wc-drop';
          const size = 4 + Math.random() * 6;
          drop.style.width  = size + 'px';
          drop.style.height = size + 'px';
          drop.style.left   = (splashX + (Math.random() - 0.5) * 20) + 'px';
          drop.style.top    = splashY + 'px';
          const angle = (Math.random() * 160 + 10) * (Math.PI / 180);
          const dist  = 15 + Math.random() * 40;
          drop.style.setProperty('--tx', (Math.cos(angle) * dist) + 'px');
          drop.style.setProperty('--ty', (-Math.sin(angle) * dist * 0.6) + 'px');
          drop.style.setProperty('--dur', (0.4 + Math.random() * 0.35) + 's');
          document.body.appendChild(drop);
          setTimeout(() => drop.remove(), 900);
        }, i * 28);
      }

      // Return can + complete
      setTimeout(() => {
        outer.classList.remove('pouring');
        outer.style.transform = '';
        // Force reflow to reset animation
        outer.classList.remove('full');
        void outer.offsetWidth;
        onComplete();
      }, 700);

    }, 380); // wait for tilt
  }

  /* â”€â”€ Public: addWater â”€â”€ called when player gets correct answer â”€â”€ */
  function addWater() {
    if (isFull || isPouring) return;

    filled = Math.min(filled + 1, ANSWERS_TO_FILL);
    setFillLevel(filled);

    if (filled >= ANSWERS_TO_FILL) {
      setFull(true);
    } else {
      const left = ANSWERS_TO_FILL - filled;
      setStatus(`${left} more correct answer${left !== 1 ? 's' : ''} to fill`);
    }
  }

  /* â”€â”€ Public: pour â”€â”€ called on can click â”€â”€ */
  function pour() {
    if (!isFull || isPouring) return;
    isPouring = true;

    // Remove ripples + full state visually while animating
    document.querySelectorAll('.wc-ripple').forEach(r => r.remove());
    setStatus('Watering...', 'poured');

    doPourAnimation(() => {
      // Drain the can
      filled = 0;
      setFillLevel(0);
      isFull    = false;
      isPouring = false;

      setStatus('Answer correctly to fill the can');
      counter.textContent = `0 / ${ANSWERS_TO_FILL} correct answers`;

      // Fire event for your game to listen to
      document.dispatchEvent(new CustomEvent('wc:poured'));
    });
  }

  /* â”€â”€ Public: reset â”€â”€ */
  function reset() {
    filled    = 0;
    isFull    = false;
    isPouring = false;
    outer.classList.remove('full', 'pouring');
    outer.style.transform = '';
    document.querySelectorAll('.wc-ripple').forEach(r => r.remove());
    setFillLevel(0);
    setStatus('Answer correctly to fill the can');
  }

  /* â”€â”€ Init â”€â”€ */
  buildDots();
  setFillLevel(0);

  return { addWater, pour, reset };

})();


/* ================================================
   DEMO WIRING (remove in your game)
   Replace addWater() calls with your answer checker
   ================================================ */
let pourCount = 0;

document.getElementById('btn-correct').addEventListener('click', () => {
  WateringCan.addWater();
});

document.getElementById('btn-reset').addEventListener('click', () => {
  pourCount = 0;
  WateringCan.reset();
  document.getElementById('demo-log').textContent = '';
});

document.addEventListener('wc:full', () => {
  document.getElementById('demo-log').textContent = 'ðŸª£ Can is full â€” click it to water!';
});

document.addEventListener('wc:poured', () => {
  pourCount++;
  document.getElementById('demo-log').textContent =
    `ðŸ’§ Watered! (${pourCount} time${pourCount !== 1 ? 's' : ''}) â€” fire plantWatered(${pourCount}) in your game here`;
});
</script>

</body>
</html>
